{% load static %}

<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>I.Sly()</title>

    <!-- Bootstrap core CSS -->
    <link href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="{% static 'assets/css/fontawesome.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/templatemo-cyborg-gaming.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/owl.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/animate.css' %}">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
<!--

TemplateMo 579 Cyborg Gaming

https://templatemo.com/tm-579-cyborg-gaming

-->
  </head>

<body>

  <!-- ***** Preloader Start ***** -->
{% include "navbar.html" %}

  <!-- ***** Header Area End ***** -->
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="page-content">

          <!-- ***** Banner Start ***** -->

          <div class="row justify-content-center mt-5">
            <div class="col-md-4">
              <div class="from-group">
                <h4>Try login</h4>
                <form method="post" action="{% url 'login' %}">
                  {% csrf_token %} <!-- *CSRF 공격 방지하기 위함 -->

                  <!-- Raon Added Start -->
                  {% if request.GET.next %}
                      <input type="hidden" name="next" value="{{ request.GET.next }}">
                  {% endif %}
                  <!-- Raon Added End -->

                  {% include "login/error.html" %}
                  
                  <div class="mb-3">
                    <label for="username">사용자ID</label>
                    <br>
                    <input type="text" class="form-control" name="username" id="username"
                        placeholder="write your ID"
                        value="{{ form.username.value|default_if_none:'' |escape }}"> 
                          <!-- *escape : 사용자 입력 노출 방지 위함 , 특수문자나 태그 등이 html로 해석되지 않도록 하여 XSS 공격 방지가능  -->
                    
                    <br>
                    <input type="text" class="form-control" name="password" id="password"
                        placeholder="write your PW"
                        value="{{ form.password.value|default_if_none:'' |escape }}">
        
                    </div>

                    <div class="buttons">
                      <label>
                        <input type="checkbox" id="show-password">SHOW PASSWORD
                      </label>
                      <button type="submit" class="input-group_mb-4" id="login_button">login</button>
                      <script>
                        var passwordInput = document.getElementById("password");
                        var toggleButton = document.getElementById("show-password");
                        
                            // 페이지가 로드될 때 비밀번호 필드를 가림
                        passwordInput.type = "password";

                        // 비밀번호 보이기/가리기 버튼 클릭 이벤트 핸들러
                        toggleButton.addEventListener("click", function() {
                            if (passwordInput.type === "password") {
                                // 현재 비밀번호가 가려져 있는 경우: 보이기
                                passwordInput.type = "text";
                            } else {
                                // 현재 비밀번호가 보이는 경우: 가리기
                                passwordInput.type = "password";
                            }
                        });
                      </script>
                    </div>
                    <script>
                      // JavaScript 코드
                      // 세션 만료 경고 메시지를 표시하고 싶을 때 이 부분에 추가
                      window.onload = function () {
                          checkSessionStatus();
                          setInterval(checkSessionStatus, 60000);  // 1분마다 세션 상태 체크
                      };
                  
                      function checkSessionStatus() {
                          console.log('Checking session status...');
                          // 여기에서 서버에 세션 상태를 확인하는 요청을 보내고 결과에 따라 경고 메시지를 표시할 수 있습니다.
                          // 이 예시에서는 클라이언트 측에서만 세션 만료를 체크하고 경고 메시지를 표시합니다.
                          fetch('{% url 'check_session_status' %}')
                              .then(response => response.text())
                              .then(data => {
                                  if (data.includes('세션이 만료되었습니다')) {
                                      // 세션이 만료된 경우 경고창을 표시하고 '예' 버튼이 클릭되면 로그인 페이지로 이동
                                      if (window.confirm('세션이 만료되었습니다. 다시 로그인해주세요.')) {
                                          window.location.href = '{% url 'login' %}';
                                      }
                                  }
                              })
                              .catch(error => {
                                  console.error('Error checking session status:', error);
                              });
                      }
                  </script>
                  </div>
                </form>
              </div>
              
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>
   
          <!-- ***** Gaming Library End ***** -->
  
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <p>Copyright © 2036 <a href="#">Cyborg Gaming</a> Company. All rights reserved. 
          
          <br>Design: <a href="https://templatemo.com" target="_blank" title="free CSS templates">TemplateMo</a>  Distributed By <a href="https://themewagon.com" target="_blank" >ThemeWagon</a></p>
        </div>
      </div>
    </div>
  </footer>


  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
  <script src="{% static 'vendor/bootstrap/js/bootstrap.min.js' %}"></script>

  <script src="{% static 'assets/js/isotope.min.js' %}"></script>
  <script src="{% static 'assets/js/owl-carousel.js' %}"></script>
  <script src="{% static 'assets/js/tabs.js' %}"></script>
  <script src="{% static 'assets/js/popup.js' %}"></script>
  <script src="{% static 'assets/js/custom.js' %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

</body>

</html>
